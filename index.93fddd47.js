const t=new class{constructor(t=null){this.size=4,this.board=t||this.createEmptyBoard(),this.score=0,this.status="idle"}createEmptyBoard(){return Array.from({length:this.size},()=>Array(this.size).fill(0))}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push([e,s]);if(t.length>0){let[e,s]=t[Math.floor(Math.random()*t.length)],r=.9>Math.random()?2:4;this.board[e][s]=r}}restart(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}start(){"idle"===this.status&&this.restart()}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}canMove(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(0===this.board[t][e]||e<this.size-1&&this.board[t][e]===this.board[t][e+1]||t<this.size-1&&this.board[t][e]===this.board[t+1][e])return!0;return!1}rotateBoard(t=!0){let e=this.createEmptyBoard();for(let s=0;s<this.size;s++)for(let r=0;r<this.size;r++)t?e[r][this.size-s-1]=this.board[s][r]:e[this.size-r-1][s]=this.board[s][r];this.board=e}slideAndMergeRow(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);return e.filter(t=>0!==t)}moveLeft(){let t=!1;for(let e=0;e<this.size;e++){let s=[...this.board[e]],r=this.slideAndMergeRow(s);this.board[e]=[...r,...Array(this.size-r.length).fill(0)],t||s.toString()===this.board[e].toString()||(t=!0)}t&&(this.addRandomTile(),this.checkGameOver())}moveRight(){this.board.forEach(t=>t.reverse()),this.moveLeft(),this.board.forEach(t=>t.reverse())}moveUp(){this.rotateBoard(!1),this.moveLeft(),this.rotateBoard(!0)}moveDown(){this.rotateBoard(!0),this.moveLeft(),this.rotateBoard(!1)}checkGameOver(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(2048===this.board[t][e]){this.status="win";return}this.canMove()||(this.status="lose")}};function e(){let e=t.getState();document.querySelector(".game-score").textContent=t.getScore();let s=document.querySelectorAll(".field-cell"),r=0;for(let t=0;t<4;t++)for(let i=0;i<4;i++){let o=e[t][i],a=s[r];a.className="field-cell",o>0?(a.classList.add(`field-cell--${o}`),a.textContent=o):a.textContent="",r++}let i=document.querySelector(".message-win"),o=document.querySelector(".message-lose");"win"===t.getStatus()?i.classList.remove("hidden"):"lose"===t.getStatus()&&o.classList.remove("hidden")}document.addEventListener("keydown",s=>{if("playing"===t.getStatus()){switch(s.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}e()}}),document.querySelector(".button.start").addEventListener("click",()=>{("idle"===t.getStatus()||"playing"!==t.getStatus())&&(t.restart(),e(),document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".button.start").classList.add("restart"))});
//# sourceMappingURL=index.93fddd47.js.map
